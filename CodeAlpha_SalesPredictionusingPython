import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score
np.random.seed(42)
data_size = 200
data = {
    'TV_Spend': np.random.normal(150, 50, data_size),      # Money spent on TV
    'Social_Media_Spend': np.random.normal(80, 30, data_size), # Money spent on Social
    'Radio_Spend': np.random.normal(30, 10, data_size),    # Money spent on Radio
    'Target_Segment': np.random.choice(['Youth', 'Adult', 'Senior'], data_size), # Categorical
    # Sales formula (Ground Truth): TV + 2*Social + 0.5*Radio + noise
    'Sales': np.zeros(data_size) 
}
df = pd.DataFrame(data)
segment_boost = df['Target_Segment'].map({'Youth': 20, 'Adult': 10, 'Senior': 5})
df['Sales'] = 10 + 0.1*df['TV_Spend'] + 0.2*df['Social_Media_Spend'] + 0.05*df['Radio_Spend'] + segment_boost + np.random.normal(0, 2, data_size)
print("--- Snapshot of Raw Data ---")
print(df.head())
df_clean = pd.get_dummies(df, columns=['Target_Segment'], drop_first=True)
X = df_clean.drop('Sales', axis=1) 
y = df_clean['Sales']              
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
model = LinearRegression()
model.fit(X_train, y_train)
predictions = model.predict(X_test)
r2 = r2_score(y_test, predictions)
print(f"\nModel Accuracy (R-Squared): {r2:.2f}") 
coefficients = pd.DataFrame(model.coef_, X.columns, columns=['Impact'])
print("\n--- Business Insights: Impact per $1 Spend ---")
print(coefficients)
plt.figure(figsize=(10, 6))
sns.regplot(x=y_test, y=predictions, scatter_kws={'alpha':0.5}, line_kws={'color':'red'})
plt.xlabel('Actual Sales')
plt.ylabel('Predicted Sales')
plt.title('Actual vs Predicted Sales (Linear Regression)')
plt.show()
